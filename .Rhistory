ymax = `TEMP.max.max`)) +
geom_boxplot(stat = "identity") +
facet_wrap(~ID) +
scale_x_continuous(breaks=seq(1,12),labels=levels(monthly.ranges$Bsubstr))
print(plot.ranges)
plot.ranges <- ggplot(data = monthly.ranges,
aes(x = B,
ymin = `TEMP.min.min`,
lower = `TEMP.mean.min`,
middle = `TEMP`,
upper = `TEMP.mean.max`,
ymax = `TEMP.max.max`)) +
geom_boxplot(stat = "identity") +
facet_wrap(~ID) +
scale_x_discrete(breaks=seq(1,12),labels=levels(monthly.ranges$Bsubstr))
print(plot.ranges)
monthly.ranges$ID <- paste(monthly.ranges$NAME, " (",monthly.ranges$USAF,")", sep = "")
monthly.ranges$Bsubstr  <- substr(monthly.ranges$B,1,1)
plot.ranges <- ggplot(data = monthly.ranges,
aes(x = B,
ymin = `TEMP.min.min`,
lower = `TEMP.mean.min`,
middle = `TEMP`,
upper = `TEMP.mean.max`,
ymax = `TEMP.max.max`)) +
geom_boxplot(stat = "identity") +
facet_wrap(~ID) +
scale_x_discrete(labels=levels(monthly.ranges$Bsubstr))
print(plot.ranges)
plot.ranges <- ggplot(data = monthly.ranges,
aes(x = B,
ymin = `TEMP.min.min`,
lower = `TEMP.mean.min`,
middle = `TEMP`,
upper = `TEMP.mean.max`,
ymax = `TEMP.max.max`)) +
geom_boxplot(stat = "identity") +
facet_wrap(~ID) +
scale_x_discrete(breaks =levels(monthly.ranges$Bsubstr),
labels=levels(monthly.ranges$Bsubstr))
print(plot.ranges)
?scale_x_discrete
plot.ranges <- ggplot(data = monthly.ranges,
aes(x = B,
ymin = `TEMP.min.min`,
lower = `TEMP.mean.min`,
middle = `TEMP`,
upper = `TEMP.mean.max`,
ymax = `TEMP.max.max`)) +
geom_boxplot(stat = "identity") +
facet_wrap(~ID) +
scale_x_discrete("Month",
labels=levels(monthly.ranges$Bsubstr))
print(plot.ranges)
levels(monthly.ranges$Bsubstr)
monthly.ranges$Bsubstr  <- as.factor(substr(monthly.ranges$B,1,1))
levels(monthly.ranges$Bsubstr)
labels=substr(levels(monthly.ranges$B),1,1)
labels
monthly.ranges$ID <- paste(monthly.ranges$NAME, " (",monthly.ranges$USAF,")", sep = "")
monthly.ranges$Bsubstr  <- substr(monthly.ranges$B,1,1)
plot.ranges <- ggplot(data = monthly.ranges,
aes(x = B,
ymin = `TEMP.min.min`,
lower = `TEMP.mean.min`,
middle = `TEMP`,
upper = `TEMP.mean.max`,
ymax = `TEMP.max.max`)) +
geom_boxplot(stat = "identity") +
facet_wrap(~ID) +
scale_x_discrete("Month",
labels=substr(levels(monthly.ranges$B),1,1))
print(plot.ranges)
plot.ranges <- ggplot(data = monthly.ranges,
aes(x = B,
ymin = `WIND.SPD.min.min`,
lower = `WIND.SPD.mean.min`,
middle = `WIND.SPD`,
upper = `WIND.SPD.mean.max`,
ymax = `WIND.SPD.max.max`)) +
geom_boxplot(stat = "identity") +
facet_wrap(~ID) +
scale_x_discrete("Month",
labels=substr(levels(monthly.ranges$B),1,1))
print(plot.ranges)
ggsave(file.path(data.dir,"figures","MonthlyWindSPeedRange.png"),
plot = monthly.max.map,
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
dev.off
dev.off()
plot.ranges <- ggplot(data = monthly.ranges,
aes(x = B,
ymin = `TEMP.min.min`,
lower = `TEMP.mean.min`,
middle = `TEMP`,
upper = `TEMP.mean.max`,
ymax = `TEMP.max.max`)) +
geom_boxplot(stat = "identity") +
facet_wrap(~ID) +
scale_x_discrete("Month",
labels=substr(levels(monthly.ranges$B),1,1))
print(plot.ranges)
ggsave(file.path(data.dir,"figures","MonthlyTemperatureRange.png"),
plot = monthly.max.map,
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
# wind speed
plot.ranges <- ggplot(data = monthly.ranges,
aes(x = B,
ymin = `WIND.SPD.min.min`,
lower = `WIND.SPD.mean.min`,
middle = `WIND.SPD`,
upper = `WIND.SPD.mean.max`,
ymax = `WIND.SPD.max.max`)) +
geom_boxplot(stat = "identity") +
facet_wrap(~ID) +
scale_x_discrete("Month",
labels=substr(levels(monthly.ranges$B),1,1))
print(plot.ranges)
ggsave(file.path(data.dir,"figures","MonthlyWindSpeedRange.png"),
plot = monthly.max.map,
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
plot.temp.ranges <- ggplot(data = monthly.ranges,
aes(x = B,
ymin = `TEMP.min.min`,
lower = `TEMP.mean.min`,
middle = `TEMP`,
upper = `TEMP.mean.max`,
ymax = `TEMP.max.max`)) +
geom_boxplot(stat = "identity") +
facet_wrap(~ID) +
scale_x_discrete("Month",
labels=substr(levels(monthly.ranges$B),1,1))
print(plot.temp.ranges)
ggsave(file.path(data.dir,"figures","MonthlyTemperatureRange.png"),
plot = plot.temp.ranges,
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
# wind speed
plot.wind.speed.ranges <- ggplot(data = monthly.ranges,
aes(x = B,
ymin = `WIND.SPD.min.min`,
lower = `WIND.SPD.mean.min`,
middle = `WIND.SPD`,
upper = `WIND.SPD.mean.max`,
ymax = `WIND.SPD.max.max`)) +
geom_boxplot(stat = "identity") +
facet_wrap(~ID) +
scale_x_discrete("Month",
labels=substr(levels(monthly.ranges$B),1,1))
print(plot.wind.speed.ranges)
ggsave(file.path(data.dir,"figures","MonthlyWindSpeedRange.png"),
plot = plot.wind.speed.ranges,
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
?theme
theme_set(theme_gray(base_size = 10))
theme_update(axis.text.x = theme_text(size=0.8),
axis.text.y = theme_text(size=0.8))
?element_text
theme_set(theme_gray(base_size = 10))
theme_update(axis.text.x = element_text(size=0.8),
axis.text.y = element_text(size=0.8))
plot.temp.ranges <- ggplot(data = monthly.ranges,
aes(x = B,
ymin = `TEMP.min.min`,
lower = `TEMP.mean.min`,
middle = `TEMP`,
upper = `TEMP.mean.max`,
ymax = `TEMP.max.max`)) +
geom_boxplot(stat = "identity") +
facet_wrap(~ID) +
scale_x_discrete("Month",
labels=substr(levels(monthly.ranges$B),1,1))
print(plot.temp.ranges)
ggsave(file.path(data.dir,"figures","MonthlyTemperatureRange.png"),
plot = plot.temp.ranges,
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
# wind speed
plot.wind.speed.ranges <- ggplot(data = monthly.ranges,
aes(x = B,
ymin = `WIND.SPD.min.min`,
lower = `WIND.SPD.mean.min`,
middle = `WIND.SPD`,
upper = `WIND.SPD.mean.max`,
ymax = `WIND.SPD.max.max`)) +
geom_boxplot(stat = "identity") +
facet_wrap(~ID) +
scale_x_discrete("Month",
labels=substr(levels(monthly.ranges$B),1,1))
print(plot.wind.speed.ranges)
ggsave(file.path(data.dir,"figures","MonthlyWindSpeedRange.png"),
plot = plot.wind.speed.ranges,
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
theme_set(theme_gray(base_size = 10))
theme_update(axis.text.x = element_text(size=rel(0.8)),
axis.text.y = element_text(size=rel(0.8)))
plot.temp.ranges <- ggplot(data = monthly.ranges,
aes(x = B,
ymin = `TEMP.min.min`,
lower = `TEMP.mean.min`,
middle = `TEMP`,
upper = `TEMP.mean.max`,
ymax = `TEMP.max.max`)) +
geom_boxplot(stat = "identity") +
facet_wrap(~ID) +
scale_x_discrete("Month",
labels=substr(levels(monthly.ranges$B),1,1))
print(plot.temp.ranges)
ggsave(file.path(data.dir,"figures","MonthlyTemperatureRange.png"),
plot = plot.temp.ranges,
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
# wind speed
plot.wind.speed.ranges <- ggplot(data = monthly.ranges,
aes(x = B,
ymin = `WIND.SPD.min.min`,
lower = `WIND.SPD.mean.min`,
middle = `WIND.SPD`,
upper = `WIND.SPD.mean.max`,
ymax = `WIND.SPD.max.max`)) +
geom_boxplot(stat = "identity") +
facet_wrap(~ID) +
scale_x_discrete("Month",
labels=substr(levels(monthly.ranges$B),1,1))
print(plot.wind.speed.ranges)
ggsave(file.path(data.dir,"figures","MonthlyWindSpeedRange.png"),
plot = plot.wind.speed.ranges,
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
station.map <- MapStations(base.map = base.map,
stations = stations.all,
labels = TRUE)
ggsave(file.path(data.dir,"figures","MapStationsByUSAF.png"),
plot = station.map,
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
source('~/Documents/projects/active/Rcode/SurfaceStationSummary/SurfaceStationSummary.R')
source('~/Documents/projects/active/Rcode/SurfaceStationSummary/scripts/LoadPackages.R')
source('~/Documents/projects/active/Rcode/SurfaceStationSummary/scripts/LoadPackages.R')
source('~/Documents/projects/active/Rcode/SurfaceStationSummary/scripts/LoadPackages.R')
source('~/Documents/projects/active/Rcode/SurfaceStationSummary/SurfaceStationSummary.R')
# create a LaTeX table for reference
WriteStationInformation(stations.all,
data.dir,
country.code)
base.map <- CreateBaseMap(lat.range = lat.range,
long.range = long.range)
ggsave(file.path(data.dir,"figures","MapBase.png"),
plot = base.map,
scale = 1, width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
base.map <- CreateBaseMap(lat.range = lat.range,
long.range = long.range)
ggsave(file.path(data.dir,"maps","MapBase.png"),
plot = base.map,
scale = 1, width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
## Map the stations ----
station.map <- MapStations(base.map = base.map,
stations = stations.all,
labels = TRUE)
ggsave(file.path(data.dir,"maps","MapStationsByUSAF.png"),
plot = station.map,
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
# Create and plot information about all data ----
# start with counts per year
PlotDataCountsByTimeInterval(GetDataCountsByTimeInterval(obs.all,
interval = "year"),
interval = "year")
ggsave(file.path(data.dir,"figures","PlotDataCountByYear.png"),
plot = count.map,
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
PlotDataCountsByTimeInterval(GetDataCountsByTimeInterval(obs.all,
interval = "hour"),
interval = "hour")
ggsave(file.path(data.dir,"figures","PlotDataCountByHour.png"),
plot = count.map,
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
PlotDataCountsByTimeInterval(GetDataCountsByTimeInterval(obs.all,
interval = "year"),
interval = "year")
ggsave(file.path(data.dir,"figures","PlotDataCountByYear.png"),
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
PlotDataCountsByTimeInterval(GetDataCountsByTimeInterval(obs.all,
interval = "hour"),
interval = "hour")
ggsave(file.path(data.dir,"figures","PlotDataCountByHour.png"),
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
# map the counts by year
MapDataCountsByTimeInterval(obs.all,
stations.all,
interval = "year",
lat.range = lat.range,
long.range = long.range)
ggsave(file.path(data.dir,"maps","MapDataCountByYear.png"),
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
monthly.mean.mean <- merge(stations.all,
getCalendarMonthStatistics(getDailyStatistics(obs.all,
stat = "mean"),
stat = "mean"),
by = "USAF")
monthly.means.map <- ggmap(get_map(location = c(min(long.range),
min(lat.range),
max(long.range),
max(lat.range)),
source = "osm"),
base_layer = ggplot(aes(x = LONG,
y = LAT),
data = monthly.mean.mean)) +
geom_point(aes(size = WIND.SPD),
alpha = 0.5) +
facet_wrap(~B) +
scale_size_area(name = "Wind Speed") +
labs(x = "Longitude",
y = "Latitude") +
coord_map()
print(monthly.means.map)
save(file.path(data.dir,"maps","MapMonthlyMeanWindSpeed.png"),
plot = monthly.means.map,
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
save(file.path(data.dir,"maps","MapMonthlyMeanWindSpeed.png"),
plot = monthly.means.map,
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
data.dir
monthly.means.map
ggsave(file.path(data.dir,"maps","MapMonthlyMeanWindSpeed.png"),
plot = monthly.means.map,
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
monthly.max.max <- merge(stations.all,
getCalendarMonthStatistics(getDailyStatistics(obs.all,
stat = "max"),
stat = "max"),
by = "USAF")
monthly.max.map <- ggmap(get_map(location = c(min(long.range),
min(lat.range),
max(long.range),
max(lat.range)),
source = "osm"),
base_layer = ggplot(aes(x = LONG,
y = LAT),
data = monthly.max.max)) +
geom_point(aes(colour = WIND.SPD),
alpha = 0.5) +
facet_wrap(~B) +
scale_color_continuous(name = "Wind Speed",
high = "red",
low = "blue",
limits = c(0,30)) +
labs(x = "Longitude",
y = "Latitude") +
coord_map()
print(monthly.max.map)
ggsave(file.path(data.dir,"maps","MapMonthlyMaximumWindSpeed.PNG"),
plot = monthly.max.map,
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
# create ribbons for each station showing ranges ----
monthly.min.min <- merge(stations.all,
getCalendarMonthStatistics(getDailyStatistics(obs.all,
stat = "min"),
stat = "min"),
by.x = "USAF",
by.y = "USAF")
monthly.mean.min <- merge(stations.all,
getCalendarMonthStatistics(getDailyStatistics(obs.all,
stat = "min"),
stat = "mean"),
by.x = "USAF",
by.y = "USAF")
monthly.mean.max <- merge(stations.all,
getCalendarMonthStatistics(getDailyStatistics(obs.all,
stat = "max"),
stat = "mean"),
by.x = "USAF",
by.y = "USAF")
monthly.ranges <- merge(merge(merge(monthly.max.max,
monthly.mean.max,
by = c("USAF","WBAN","B","NAME","CTRY","STATE","CALL","LAT","LONG","ELEV","BEGIN","END"),
suffixes = c(".max.max",".mean.max")),
merge(monthly.mean.min,
monthly.min.min,
by = c("USAF","WBAN","B","NAME","CTRY","STATE","CALL","LAT","LONG","ELEV","BEGIN","END"),
suffixes = c(".mean.min",".min.min")),
by = c("USAF","WBAN","B","NAME","CTRY","STATE","CALL","LAT","LONG","ELEV","BEGIN","END")),
monthly.mean.mean,
by = c("USAF","WBAN","B","NAME","CTRY","STATE","CALL","LAT","LONG","ELEV","BEGIN","END"),
suffixes = c("",".mean.mean"))
# plot this
monthly.ranges$ID <- paste(monthly.ranges$NAME, " (",monthly.ranges$USAF,")", sep = "")
monthly.ranges$Bsubstr  <- substr(monthly.ranges$B,1,1)
plot.temp.ranges <- ggplot(data = monthly.ranges,
aes(x = B,
ymin = `TEMP.min.min`,
lower = `TEMP.mean.min`,
middle = `TEMP`,
upper = `TEMP.mean.max`,
ymax = `TEMP.max.max`)) +
geom_boxplot(stat = "identity") +
facet_wrap(~ID) +
scale_x_discrete("Month",
labels=substr(levels(monthly.ranges$B),1,1))
print(plot.temp.ranges)
ggsave(file.path(data.dir,"figures","PlotMonthlyTemperatureRange.png"),
plot = plot.temp.ranges,
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
# wind speed
plot.wind.speed.ranges <- ggplot(data = monthly.ranges,
aes(x = B,
ymin = `WIND.SPD.min.min`,
lower = `WIND.SPD.mean.min`,
middle = `WIND.SPD`,
upper = `WIND.SPD.mean.max`,
ymax = `WIND.SPD.max.max`)) +
geom_boxplot(stat = "identity") +
facet_wrap(~ID) +
scale_x_discrete("Month",
labels=substr(levels(monthly.ranges$B),1,1)) +
print(plot.wind.speed.ranges)
ggsave(file.path(data.dir,"figures","PlotMonthlyWindSpeedRange.png"),
plot = plot.wind.speed.ranges,
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
plot.wind.speed.ranges <- ggplot(data = monthly.ranges,
aes(x = B,
ymin = `WIND.SPD.min.min`,
lower = `WIND.SPD.mean.min`,
middle = `WIND.SPD`,
upper = `WIND.SPD.mean.max`,
ymax = `WIND.SPD.max.max`)) +
geom_boxplot(stat = "identity") +
facet_wrap(~ID) +
scale_x_discrete("Month",
labels=substr(levels(monthly.ranges$B),1,1)) +
labs(y = "Wind Speed")
print(plot.wind.speed.ranges)
ggsave(file.path(data.dir,"figures","PlotMonthlyWindSpeedRange.png"),
plot = plot.wind.speed.ranges,
scale = 1,
width = 9,
height = 6, units = c("in"),
dpi = 300, limitsize = TRUE)
# Create daily data (we'll need this for monthly values, later)
#source(file.path(code.dir,"scripts","GetDailyDataStatistics.R"))
# create monthly data
#source(file.path(code.dir,"scripts","GetMonthlyDataStatistics.R"))
#source(file.path(code.dir,"scripts","PlotMonthlyDataStatistics.R"))
#source(file.path(code.dir,"scripts","GetMonthlyDataCorrelations.R"))
#source(file.path(code.dir,"scripts","MapMonthlyDataCorrelations.R"))
# Create climatologies
#source(file.path(code.dir,"scripts","GetMonthlyClimatology.R"))
#source(file.path(code.dir,"scripts","PlotMonthlyClimatology.R"))
